{% extends 'base.html' %}

{% block title %}{{ topic.title if topic else 'Tema no encontrado' }}{% endblock %}

{% block content %}
  {% if topic %}
  <div class="forum-topic-container">
    <button onclick="window.location.href='{{ url_for('forum_index') }}'" class="back-btn">‚Üê Volver al foro</button>
    <h1 class="topic-title">{{ topic.title }}</h1>
    <p class="topic-meta">Categor√≠a: {{ topic.category }} ‚Ä¢ {{ topic.created_at.strftime('%d %b %Y, %H:%M') }}</p>
    <div class="topic-body">{{ topic.description }}</div>
    <hr/>
    <h2 class="responses-title">Respuestas</h2>
    {% for r in responses %}
    <div class="response-card">
      <div class="meta">{{ r.author }} ‚Ä¢ {{ r.created_at.strftime('%d %b %Y, %H:%M') }}</div>
      <p class="content">{{ r.content }}</p>
      <div class="voting">
        <form action="{{ url_for('vote_response', response_id=r.id) }}" method="post">
          <button name="delta" value="1">üëç</button>
          <span class="score">{{ r.score }}</span>
          <button name="delta" value="-1">üëé</button>
        </form>
      </div>
    </div>
    {% else %}
    <p class="no-resp">No hay respuestas a√∫n. S√© el primero en responder:</p>
    {% endfor %}
    <form action="{{ url_for('create_response', topic_id=topic.id) }}" method="post">
      <textarea name="content" required placeholder="Tu respuesta‚Ä¶"></textarea>
      <button type="submit">Responder</button>
    </form>
  </div>
  {% else %}
  <div class="alert alert-warning">
    No encontramos ese tema. <a href="{{ url_for('forum_index') }}">Volver al foro</a>
  </div>
  {% endif %}
{% endblock %}
