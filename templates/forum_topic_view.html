{% extends 'base.html' %}

{% block title %}{{ topic.title if topic else 'Tema no encontrado' }}{% endblock %}

{% block content %}
  {% if topic %}
  <div class="forum-topic-container">
    <button onclick="window.location.href='{{ url_for('list_forum') }}'" class="back-btn">← Volver al foro</button>
    <h1 class="topic-title">{{ topic.title or topic.titulo }}</h1>
    <p class="topic-meta">Categoría: {{ topic.category or topic.categoria }} • {{ (topic.created_at or topic.fecha or topic.timestamp) | time_ago }}</p>
    <div class="topic-body">{{ topic.description or topic.contenido }}</div>
    <hr/>
    <h2 class="responses-title">Respuestas</h2>
    {% for r in responses %}
      <div class="response-card">
        <p class="response-body">{{ r.content or r.body }}</p>
        <p class="response-meta">por {{ r.author }} • {{ (r.created_at or r.timestamp) | time_ago }}</p>
      </div>
    {% else %}
      <p class="no-resp">Sé el primero en responder este tema.</p>
    {% endfor %}
    <form class="reply-form" action="{{ url_for('forum_reply', topic_id=topic.id) }}" method="post">
      <label for="author">Nombre</label>
      <input id="author" name="author" type="text" required>
      <label for="content">Respuesta</label>
      <textarea id="content" name="content" required></textarea>
      <button type="submit" class="reply-btn">Enviar respuesta</button>
    </form>
  </div>
  {% else %}
  <div class="alert alert-warning">
    No encontramos ese tema. <a href="{{ url_for('list_forum') }}">Volver al foro</a>
  </div>
  {% endif %}
{% endblock %}
